{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Volumes/document/GitHub/ASM3/Frontend Assignment 03/client/src/Share/Chat/Chat.jsx\",\n    _s = $RefreshSig$();\n\n// import React, { useState, useEffect, useRef } from \"react\";\n// import socketIOClient from \"socket.io-client\";\n// import \"./Chat.css\";\n// import Cookies from \"universal-cookie\";\n// const host = \"http://localhost:5001\";\n// function Chat() {\n//   const [mess, setMess] = useState([]);\n//   const [message, setMessage] = useState(\"\");\n//   const socketRef = useRef();\n//   const messagesEnd = useRef();\n//   const cookies = new Cookies();\n//   const accessToken = cookies.get(\"accessToken\");\n//   console.log(accessToken?.role);\n//   console.log(accessToken);\n//   useEffect(() => {\n//     socketRef.current = socketIOClient.connect(host);\n//     socketRef.current.on(\"receive-message\", (dataGot) => {\n//       setMess((oldMsgs) => [...oldMsgs, dataGot]);\n//       scrollToBottom(); // Scroll to the latest message\n//     });\n//     return () => {\n//       socketRef.current.disconnect();\n//     };\n//   }, []);\n//   console.log(mess);\n//   const sendMessage = () => {\n//     if (message.trim() !== \"\") { // Check if the message is not empty or whitespace\n//       const msg = {\n//         room: 1,\n//         message: message,\n//         idAdmin: false\n//       };\n//       socketRef.current.emit(\"send-message\", msg);\n//       setMessage(\"\");\n//     }\n//   };\n//   const onChangeText = (e) => {\n//     setMessage(e.target.value);\n//   };\n//   const handlerSend = (e) => {\n//     if (e.key === \"Enter\" && !e.shiftKey) {\n//       e.preventDefault();\n//       sendMessage();\n//     }\n//   };\n//   const scrollToBottom = () => {\n//     messagesEnd.current.scrollIntoView({ behavior: \"smooth\" });\n//   };\n//   return (\n//     <div className=\"wrapper_chat\">\n//       <div className=\"chat_messenger\" >\n//         <svg x=\"0\" y=\"0\" width=\"60px\" height=\"60px\">\n//           <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n//             <g>\n//               <circle fill=\"#383838\" cx=\"30\" cy=\"30\" r=\"30\"></circle>\n//               <svg x=\"10\" y=\"10\">\n//                 <g transform=\"translate(0.000000, -10.000000)\" fill=\"#FFFFFF\">\n//                   <g id=\"logo\" transform=\"translate(0.000000, 10.000000)\">\n//                     <path\n//                       d=\"M20,0 C31.2666,0 40,8.2528 40,19.4 C40,30.5472 31.2666,38.8 \n// \t\t\t\t\t\t\t\t20,38.8 C17.9763,38.8 16.0348,38.5327 14.2106,38.0311 C13.856,37.9335 13.4789,37.9612 \n// \t\t\t\t\t\t\t\t13.1424,38.1098 L9.1727,39.8621 C8.1343,40.3205 6.9621,39.5819 6.9273,38.4474 L6.8184,34.8894 \n// \t\t\t\t\t\t\t\tC6.805,34.4513 6.6078,34.0414 6.2811,33.7492 C2.3896,30.2691 0,25.2307 0,19.4 C0,8.2528 8.7334,0 \n// \t\t\t\t\t\t\t\t20,0 Z M7.99009,25.07344 C7.42629,25.96794 8.52579,26.97594 9.36809,26.33674 L15.67879,21.54734 \n// \t\t\t\t\t\t\t\tC16.10569,21.22334 16.69559,21.22164 17.12429,21.54314 L21.79709,25.04774 C23.19919,26.09944 \n// \t\t\t\t\t\t\t\t25.20039,25.73014 26.13499,24.24744 L32.00999,14.92654 C32.57369,14.03204 31.47419,13.02404 \n// \t\t\t\t\t\t\t\t30.63189,13.66324 L24.32119,18.45264 C23.89429,18.77664 23.30439,18.77834 22.87569,18.45674 \n// \t\t\t\t\t\t\t\tL18.20299,14.95224 C16.80079,13.90064 14.79959,14.26984 13.86509,15.75264 L7.99009,25.07344 Z\"\n//                     ></path>\n//                   </g>\n//                 </g>\n//               </svg>\n//             </g>\n//           </g>\n//         </svg>\n//       </div>\n//       <div className=\"active_chat animate__animated animate__jackInTheBox\">\n//         <div style={{ width: \"100%\" }}>\n//           <div\n//             className=\"card card-bordered fix_boderChat\"\n//             style={{ width: \"fit-content\" }}\n//           >\n//             <div className=\"card-header\">\n//               <h4 className=\"card-title\">\n//                 <strong>Customer Support</strong>\n//               </h4>{\" \"}\n//               <a className=\"btn btn-xs btn-secondary\" href=\"#\">\n//                 Let's Chat App\n//               </a>\n//             </div>\n//             <div className=\"ps-container ps-theme-default ps-active-y fix_scoll\">\n//               {mess &&\n//                 mess.map((value) =>\n//                   !value.is_admin ? (\n//                     <div\n//                       className=\"media media-chat media-chat-reverse\"\n//                       key={value.index}\n//                     >\n//                       <div className=\"media-body\">\n//                         <p>You: {value.content}</p>\n//                       </div>\n//                     </div>\n//                   ) : (\n//                     <div className=\"media media-chat\" key={value.id}>\n//                       {\" \"}\n//                       <img\n//                         className=\"avatar\"\n//                         src=\"https://img.icons8.com/color/36/000000/administrator-male.png\"\n//                         alt=\"...\"\n//                       />\n//                       <div className=\"media-body\" key={value.index}>\n//                         <p>Cộng tác viên: {value.content}</p>\n//                       </div>\n//                     </div>\n//                   )\n//                 )}\n//                 <div style={{ float:\"left\", clear: \"both\" }}\n//              ref={messagesEnd}>\n//         </div>\n//             </div>\n//             <div className=\"publisher bt-1 border-light\">\n//               <img\n//                 className=\"avatar avatar-xs\"\n//                 src=\"https://img.icons8.com/color/36/000000/administrator-male.png\"\n//                 alt=\"...\"\n//               />\n//               <input\n//                 type=\"text\"\n//                 placeholder=\"Enter Message!\"\n//                 onChange={onChangeText}\n//                 value={message}\n//                 style={{ width: \"80%\" }}\n//                 onKeyDown={handlerSend}\n//               />\n//               <a\n//                 onClick={sendMessage}\n//                 className=\"publisher-btn text-info\"\n//                 data-abc=\"true\"\n//               >\n//                 <i className=\"fa fa-paper-plane\"></i>\n//               </a>\n//             </div>\n//           </div>\n//         </div>\n//       </div>\n//     </div>\n//   );\n// }\n// export default Chat;\nimport React, { useEffect, useRef, useState, useSelector } from 'react';\nimport './Chat.css';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\nimport MessengerAPI from '../../API/MessengerAPI';\nconst socket = io('http://localhost:5001'); // Thay đổi URL của server Socket.IO tại đây\n\nfunction Chat(props) {\n  _s();\n\n  const [activeChat, setActiveChat] = useState(false);\n  const [textMessage, setTextMessage] = useState('');\n  const [message, setMessage] = useState([]);\n  const id_admin = '5ff808424e24e9118cee77b2';\n  const id_user = useSelector(state => state.Session.idUser);\n  const [loadMessage, setLoadMessage] = useState('');\n  const [load, setLoad] = useState(false);\n  const timeRef = useRef(null); // Hàm này dùng để mở hộp thoại chat\n\n  const onChat = () => {\n    setActiveChat(!activeChat);\n  };\n\n  const onChangeText = e => {\n    setTextMessage(e.target.value);\n  };\n\n  const handlerSend = () => {\n    if (textMessage.trim() !== '') {\n      const data = {\n        id_user1: id_user,\n        id_user2: id_admin,\n        id: Math.random().toString(),\n        message: textMessage,\n        name: sessionStorage.getItem('name_user'),\n        category: 'send'\n      };\n      const data_partner = {\n        id_user1: id_admin,\n        id_user2: id_user,\n        id: Math.random().toString(),\n        message: textMessage,\n        name: sessionStorage.getItem('name_user'),\n        category: 'receive'\n      };\n      socket.emit('send_message', data);\n\n      const postData = async () => {\n        const query = '?' + queryString.stringify(data);\n        const query_partner = '?' + queryString.stringify(data_partner);\n        await MessengerAPI.postMessage(query);\n        const res = await MessengerAPI.postMessage(query_partner);\n\n        if (res) {\n          setLoad(true);\n        }\n      };\n\n      postData();\n      setTextMessage('');\n    }\n  };\n\n  useEffect(() => {\n    socket.on('receive_message', () => {\n      setLoad(true);\n    });\n    return () => {\n      socket.off('receive_message');\n    };\n  }, []);\n  useEffect(() => {\n    if (activeChat) {\n      handlePollingMessage();\n    } else {\n      clearTimeout(timeRef.current);\n    }\n  }, [activeChat]); // Hàm này dùng để load dữ liệu message của user khi user gửi tin nhán\n\n  const fetchMessageData = async () => {\n    const params = {\n      id_user1: id_user,\n      id_user2: id_admin\n    };\n    const query = '?' + queryString.stringify(params);\n    const response = await MessengerAPI.getMessage(query);\n    setMessage(response.content);\n\n    if (response) {\n      return true;\n    }\n  }; // Hàm này là thay đổi state loadMessage phụ thuộc vào redux id_user\n\n\n  const updateLoadMessage = () => {\n    if (!id_user) {\n      setLoadMessage('');\n    } else {\n      setLoadMessage(id_user);\n    }\n  };\n\n  useEffect(() => {\n    updateLoadMessage();\n  }, [id_user]);\n  useEffect(() => {\n    if (load) {\n      fetchMessageData();\n      setLoad(false);\n    }\n  }, [load]);\n\n  const handlePollingMessage = () => {\n    timeRef.current = setTimeout(async () => {\n      const flag = await fetchMessageData();\n\n      if (flag && activeChat) {\n        handlePollingMessage();\n      }\n    }, 3000);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: id_user && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"wrapper_chat\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat_messenger\",\n          onClick: onChat,\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            x: \"0\",\n            y: \"0\",\n            width: \"60px\",\n            height: \"60px\",\n            children: /*#__PURE__*/_jsxDEV(\"g\", {\n              stroke: \"none\",\n              strokeWidth: \"1\",\n              fill: \"none\",\n              fillRule: \"evenodd\",\n              children: /*#__PURE__*/_jsxDEV(\"g\", {\n                children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                  fill: \"#383838\",\n                  cx: \"30\",\n                  cy: \"30\",\n                  r: \"30\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n                  x: \"10\",\n                  y: \"10\",\n                  children: /*#__PURE__*/_jsxDEV(\"g\", {\n                    transform: \"translate(0.000000, -10.000000)\",\n                    fill: \"#FFFFFF\",\n                    children: /*#__PURE__*/_jsxDEV(\"g\", {\n                      id: \"logo\",\n                      transform: \"translate(0.000000, 10.000000)\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        d: \"M20,0 C31.2666,0 40,8.2528 40,19.4 C40,30.5472 31.2666,38.8  20,38.8 C17.9763,38.8 16.0348,38.5327 14.2106,38.0311 C13.856,37.9335 13.4789,37.9612  13.1424,38.1098 L9.1727,39.8621 C8.1343,40.3205 6.9621,39.5819 6.9273,38.4474 L6.8184,34.8894  C6.805,34.4513 6.6078,34.0414 6.2811,33.7492 C2.3896,30.2691 0,25.2307 0,19.4 C0,8.2528 8.7334,0  20,0 Z M7.99009,25.07344 C7.42629,25.96794 8.52579,26.97594 9.36809,26.33674 L15.67879,21.54734  C16.10569,21.22334 16.69559,21.22164 17.12429,21.54314 L21.79709,25.04774 C23.19919,26.09944  25.20039,25.73014 26.13499,24.24744 L32.00999,14.92654 C32.57369,14.03204 31.47419,13.02404  30.63189,13.66324 L24.32119,18.45264 C23.89429,18.77664 23.30439,18.77834 22.87569,18.45674  L18.20299,14.95224 C16.80079,13.90064 14.79959,14.26984 13.86509,15.75264 L7.99009,25.07344 Z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 309,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 308,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 307,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 73\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 21\n      }, this), activeChat && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"active_chat animate__animated animate__jackInTheBox\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '100%'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card card-bordered fix_boderChat\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"card-title\",\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Customer Support\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 72\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 45\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n                className: \"btn btn-xs btn-secondary\",\n                href: \"#\",\n                children: \"Let's Chat App\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 111\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ps-container ps-theme-default ps-active-y fix_scoll\",\n              children: message && message.map(value => value.category === 'send' ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"media media-chat media-chat-reverse\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"media-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: value.message\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 341,\n                    columnNumber: 65\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 61\n                }, this)\n              }, value.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 57\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"media media-chat\",\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"avatar\",\n                  src: \"https://img.icons8.com/color/36/000000/administrator-male.png\",\n                  alt: \"...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 345,\n                  columnNumber: 107\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"media-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [\"ADMIN: \", value.message]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 347,\n                    columnNumber: 65\n                  }, this)\n                }, value.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 61\n                }, this)]\n              }, value.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 57\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"publisher bt-1 border-light\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"avatar avatar-xs\",\n                src: \"https://img.icons8.com/color/36/000000/administrator-male.png\",\n                alt: \"...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Enter Message!\",\n                onChange: onChangeText,\n                value: textMessage\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"publisher-btn file-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-paperclip file-browser\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                className: \"publisher-btn\",\n                href: \"#\",\n                \"data-abc\": \"true\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-smile\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 362,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                onClick: handlerSend,\n                className: \"publisher-btn text-info\",\n                \"data-abc\": \"true\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-paper-plane\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 365,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 37\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n}\n\n_s(Chat, \"OUTB/pOgUB8zdVrQE0Q44yOVaJc=\", false, function () {\n  return [useSelector];\n});\n\n_c = Chat;\nexport default Chat;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"sources":["/Volumes/document/GitHub/ASM3/Frontend Assignment 03/client/src/Share/Chat/Chat.jsx"],"names":["React","useEffect","useRef","useState","useSelector","queryString","io","MessengerAPI","socket","Chat","props","activeChat","setActiveChat","textMessage","setTextMessage","message","setMessage","id_admin","id_user","state","Session","idUser","loadMessage","setLoadMessage","load","setLoad","timeRef","onChat","onChangeText","e","target","value","handlerSend","trim","data","id_user1","id_user2","id","Math","random","toString","name","sessionStorage","getItem","category","data_partner","emit","postData","query","stringify","query_partner","postMessage","res","on","off","handlePollingMessage","clearTimeout","current","fetchMessageData","params","response","getMessage","content","updateLoadMessage","setTimeout","flag","width","map"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,EAA6CC,WAA7C,QAAgE,OAAhE;AACA,OAAO,YAAP;AACA,OAAOC,WAAP,MAAwB,cAAxB;AACA,OAAOC,EAAP,MAAe,kBAAf;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AAEA,MAAMC,MAAM,GAAGF,EAAE,CAAC,uBAAD,CAAjB,C,CAA4C;;AAE5C,SAASG,IAAT,CAAcC,KAAd,EAAqB;AAAA;;AACnB,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BT,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAM,CAACU,WAAD,EAAcC,cAAd,IAAgCX,QAAQ,CAAC,EAAD,CAA9C;AACA,QAAM,CAACY,OAAD,EAAUC,UAAV,IAAwBb,QAAQ,CAAC,EAAD,CA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","sourcesContent":["// import React, { useState, useEffect, useRef } from \"react\";\n// import socketIOClient from \"socket.io-client\";\n// import \"./Chat.css\";\n// import Cookies from \"universal-cookie\";\n\n// const host = \"http://localhost:5001\";\n\n// function Chat() {\n//   const [mess, setMess] = useState([]);\n//   const [message, setMessage] = useState(\"\");\n\n//   const socketRef = useRef();\n//   const messagesEnd = useRef();\n\n//   const cookies = new Cookies();\n//   const accessToken = cookies.get(\"accessToken\");\n//   console.log(accessToken?.role);\n//   console.log(accessToken);\n\n//   useEffect(() => {\n//     socketRef.current = socketIOClient.connect(host);\n\n//     socketRef.current.on(\"receive-message\", (dataGot) => {\n//       setMess((oldMsgs) => [...oldMsgs, dataGot]);\n//       scrollToBottom(); // Scroll to the latest message\n//     });\n\n//     return () => {\n//       socketRef.current.disconnect();\n//     };\n//   }, []);\n\n//   console.log(mess);\n\n//   const sendMessage = () => {\n//     if (message.trim() !== \"\") { // Check if the message is not empty or whitespace\n//       const msg = {\n//         room: 1,\n//         message: message,\n//         idAdmin: false\n//       };\n//       socketRef.current.emit(\"send-message\", msg);\n//       setMessage(\"\");\n//     }\n//   };\n\n\n//   const onChangeText = (e) => {\n//     setMessage(e.target.value);\n//   };\n\n//   const handlerSend = (e) => {\n//     if (e.key === \"Enter\" && !e.shiftKey) {\n//       e.preventDefault();\n//       sendMessage();\n//     }\n//   };\n\n//   const scrollToBottom = () => {\n//     messagesEnd.current.scrollIntoView({ behavior: \"smooth\" });\n//   };\n\n\n//   return (\n//     <div className=\"wrapper_chat\">\n//       <div className=\"chat_messenger\" >\n//         <svg x=\"0\" y=\"0\" width=\"60px\" height=\"60px\">\n//           <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n//             <g>\n//               <circle fill=\"#383838\" cx=\"30\" cy=\"30\" r=\"30\"></circle>\n//               <svg x=\"10\" y=\"10\">\n//                 <g transform=\"translate(0.000000, -10.000000)\" fill=\"#FFFFFF\">\n//                   <g id=\"logo\" transform=\"translate(0.000000, 10.000000)\">\n//                     <path\n//                       d=\"M20,0 C31.2666,0 40,8.2528 40,19.4 C40,30.5472 31.2666,38.8 \n// \t\t\t\t\t\t\t\t20,38.8 C17.9763,38.8 16.0348,38.5327 14.2106,38.0311 C13.856,37.9335 13.4789,37.9612 \n// \t\t\t\t\t\t\t\t13.1424,38.1098 L9.1727,39.8621 C8.1343,40.3205 6.9621,39.5819 6.9273,38.4474 L6.8184,34.8894 \n// \t\t\t\t\t\t\t\tC6.805,34.4513 6.6078,34.0414 6.2811,33.7492 C2.3896,30.2691 0,25.2307 0,19.4 C0,8.2528 8.7334,0 \n// \t\t\t\t\t\t\t\t20,0 Z M7.99009,25.07344 C7.42629,25.96794 8.52579,26.97594 9.36809,26.33674 L15.67879,21.54734 \n// \t\t\t\t\t\t\t\tC16.10569,21.22334 16.69559,21.22164 17.12429,21.54314 L21.79709,25.04774 C23.19919,26.09944 \n// \t\t\t\t\t\t\t\t25.20039,25.73014 26.13499,24.24744 L32.00999,14.92654 C32.57369,14.03204 31.47419,13.02404 \n// \t\t\t\t\t\t\t\t30.63189,13.66324 L24.32119,18.45264 C23.89429,18.77664 23.30439,18.77834 22.87569,18.45674 \n// \t\t\t\t\t\t\t\tL18.20299,14.95224 C16.80079,13.90064 14.79959,14.26984 13.86509,15.75264 L7.99009,25.07344 Z\"\n//                     ></path>\n//                   </g>\n//                 </g>\n//               </svg>\n//             </g>\n//           </g>\n//         </svg>\n//       </div>\n\n//       <div className=\"active_chat animate__animated animate__jackInTheBox\">\n//         <div style={{ width: \"100%\" }}>\n//           <div\n//             className=\"card card-bordered fix_boderChat\"\n//             style={{ width: \"fit-content\" }}\n//           >\n//             <div className=\"card-header\">\n//               <h4 className=\"card-title\">\n//                 <strong>Customer Support</strong>\n//               </h4>{\" \"}\n//               <a className=\"btn btn-xs btn-secondary\" href=\"#\">\n//                 Let's Chat App\n//               </a>\n//             </div>\n//             <div className=\"ps-container ps-theme-default ps-active-y fix_scoll\">\n//               {mess &&\n//                 mess.map((value) =>\n//                   !value.is_admin ? (\n//                     <div\n//                       className=\"media media-chat media-chat-reverse\"\n//                       key={value.index}\n//                     >\n//                       <div className=\"media-body\">\n//                         <p>You: {value.content}</p>\n//                       </div>\n//                     </div>\n//                   ) : (\n//                     <div className=\"media media-chat\" key={value.id}>\n//                       {\" \"}\n//                       <img\n//                         className=\"avatar\"\n//                         src=\"https://img.icons8.com/color/36/000000/administrator-male.png\"\n//                         alt=\"...\"\n//                       />\n//                       <div className=\"media-body\" key={value.index}>\n//                         <p>Cộng tác viên: {value.content}</p>\n//                       </div>\n//                     </div>\n//                   )\n//                 )}\n//                 <div style={{ float:\"left\", clear: \"both\" }}\n//              ref={messagesEnd}>\n//         </div>\n\n//             </div>\n//             <div className=\"publisher bt-1 border-light\">\n//               <img\n//                 className=\"avatar avatar-xs\"\n//                 src=\"https://img.icons8.com/color/36/000000/administrator-male.png\"\n//                 alt=\"...\"\n//               />\n//               <input\n//                 type=\"text\"\n//                 placeholder=\"Enter Message!\"\n//                 onChange={onChangeText}\n//                 value={message}\n//                 style={{ width: \"80%\" }}\n//                 onKeyDown={handlerSend}\n//               />\n//               <a\n//                 onClick={sendMessage}\n//                 className=\"publisher-btn text-info\"\n//                 data-abc=\"true\"\n//               >\n//                 <i className=\"fa fa-paper-plane\"></i>\n//               </a>\n//             </div>\n//           </div>\n//         </div>\n//       </div>\n//     </div>\n//   );\n// }\n\n// export default Chat;\nimport React, { useEffect, useRef, useState, useSelector } from 'react';\nimport './Chat.css';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\nimport MessengerAPI from '../../API/MessengerAPI';\n\nconst socket = io('http://localhost:5001'); // Thay đổi URL của server Socket.IO tại đây\n\nfunction Chat(props) {\n  const [activeChat, setActiveChat] = useState(false);\n  const [textMessage, setTextMessage] = useState('');\n  const [message, setMessage] = useState([]);\n  const id_admin = '5ff808424e24e9118cee77b2';\n  const id_user = useSelector((state) => state.Session.idUser);\n  const [loadMessage, setLoadMessage] = useState('');\n  const [load, setLoad] = useState(false);\n  const timeRef = useRef(null);\n\n  // Hàm này dùng để mở hộp thoại chat\n  const onChat = () => {\n    setActiveChat(!activeChat);\n  };\n\n  const onChangeText = (e) => {\n    setTextMessage(e.target.value);\n  };\n\n  const handlerSend = () => {\n    if (textMessage.trim() !== '') {\n      const data = {\n        id_user1: id_user,\n        id_user2: id_admin,\n        id: Math.random().toString(),\n        message: textMessage,\n        name: sessionStorage.getItem('name_user'),\n        category: 'send',\n      };\n\n      const data_partner = {\n        id_user1: id_admin,\n        id_user2: id_user,\n        id: Math.random().toString(),\n        message: textMessage,\n        name: sessionStorage.getItem('name_user'),\n        category: 'receive',\n      };\n\n      socket.emit('send_message', data);\n\n      const postData = async () => {\n        const query = '?' + queryString.stringify(data);\n        const query_partner = '?' + queryString.stringify(data_partner);\n\n        await MessengerAPI.postMessage(query);\n        const res = await MessengerAPI.postMessage(query_partner);\n\n        if (res) {\n          setLoad(true);\n        }\n      };\n\n      postData();\n\n      setTextMessage('');\n    }\n  };\n\n  useEffect(() => {\n    socket.on('receive_message', () => {\n      setLoad(true);\n    });\n\n    return () => {\n      socket.off('receive_message');\n    };\n  }, []);\n\n  useEffect(() => {\n    if (activeChat) {\n      handlePollingMessage();\n    } else {\n      clearTimeout(timeRef.current);\n    }\n  }, [activeChat]);\n\n  // Hàm này dùng để load dữ liệu message của user khi user gửi tin nhán\n  const fetchMessageData = async () => {\n    const params = {\n      id_user1: id_user,\n      id_user2: id_admin,\n    };\n    const query = '?' + queryString.stringify(params);\n    const response = await MessengerAPI.getMessage(query);\n    setMessage(response.content);\n    if (response) {\n      return true;\n    }\n  };\n\n  // Hàm này là thay đổi state loadMessage phụ thuộc vào redux id_user\n  const updateLoadMessage = () => {\n    if (!id_user) {\n      setLoadMessage('');\n    } else {\n      setLoadMessage(id_user);\n    }\n  };\n\n  useEffect(() => {\n    updateLoadMessage();\n  }, [id_user]);\n\n  useEffect(() => {\n    if (load) {\n      fetchMessageData();\n      setLoad(false);\n    }\n  }, [load]);\n\n  const handlePollingMessage = () => {\n    timeRef.current = setTimeout(async () => {\n      const flag = await fetchMessageData();\n      if (flag && activeChat) {\n        handlePollingMessage();\n      }\n    }, 3000);\n  };\n\n\n    return (\n        <>\n            {id_user &&\n                <div>\n                    <div className=\"wrapper_chat\">\n                        <div className=\"chat_messenger\" onClick={onChat}>\n                            <svg x=\"0\" y=\"0\" width=\"60px\" height=\"60px\"><g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n                                <g>\n                                    <circle fill=\"#383838\" cx=\"30\" cy=\"30\" r=\"30\"></circle>\n                                    <svg x=\"10\" y=\"10\">\n                                        <g transform=\"translate(0.000000, -10.000000)\" fill=\"#FFFFFF\">\n                                            <g id=\"logo\" transform=\"translate(0.000000, 10.000000)\">\n                                                <path d=\"M20,0 C31.2666,0 40,8.2528 40,19.4 C40,30.5472 31.2666,38.8 \n                                        20,38.8 C17.9763,38.8 16.0348,38.5327 14.2106,38.0311 C13.856,37.9335 13.4789,37.9612 \n                                        13.1424,38.1098 L9.1727,39.8621 C8.1343,40.3205 6.9621,39.5819 6.9273,38.4474 L6.8184,34.8894 \n                                        C6.805,34.4513 6.6078,34.0414 6.2811,33.7492 C2.3896,30.2691 0,25.2307 0,19.4 C0,8.2528 8.7334,0 \n                                        20,0 Z M7.99009,25.07344 C7.42629,25.96794 8.52579,26.97594 9.36809,26.33674 L15.67879,21.54734 \n                                        C16.10569,21.22334 16.69559,21.22164 17.12429,21.54314 L21.79709,25.04774 C23.19919,26.09944 \n                                        25.20039,25.73014 26.13499,24.24744 L32.00999,14.92654 C32.57369,14.03204 31.47419,13.02404 \n                                        30.63189,13.66324 L24.32119,18.45264 C23.89429,18.77664 23.30439,18.77834 22.87569,18.45674 \n                                        L18.20299,14.95224 C16.80079,13.90064 14.79959,14.26984 13.86509,15.75264 L7.99009,25.07344 Z\">\n                                                </path>\n                                            </g>\n                                        </g>\n                                    </svg>\n                                </g>\n                            </g>\n                            </svg>\n                        </div>\n                    </div>\n                    {\n                        activeChat && (\n                            <div className='active_chat animate__animated animate__jackInTheBox'>\n                                <div style={{ width: '100%' }}>\n                                    <div className=\"card card-bordered fix_boderChat\">\n                                        <div className=\"card-header\">\n                                            <h4 className=\"card-title\"><strong>Customer Support</strong></h4> <a className=\"btn btn-xs btn-secondary\" href=\"#\">Let's Chat App</a>\n                                        </div>\n                                        <div className=\"ps-container ps-theme-default ps-active-y fix_scoll\">\n                                            {\n                                                message && message.map(value => (\n                                                    value.category === 'send' ? (\n                                                        <div className=\"media media-chat media-chat-reverse\" key={value.id}>\n                                                            <div className=\"media-body\">\n                                                                <p>{value.message}</p>\n                                                            </div>\n                                                        </div>\n                                                    ) : (\n                                                        <div className=\"media media-chat\" key={value.id}> <img className=\"avatar\" src=\"https://img.icons8.com/color/36/000000/administrator-male.png\" alt=\"...\" />\n                                                            <div className=\"media-body\" key={value.id}>\n                                                                <p>ADMIN: {value.message}</p>\n                                                            </div>\n                                                        </div>\n                                                    )\n                                                ))\n                                            }\n                                        </div>\n                                        <div className=\"publisher bt-1 border-light\">\n                                            <img className=\"avatar avatar-xs\" src=\"https://img.icons8.com/color/36/000000/administrator-male.png\" alt=\"...\" />\n                                            <input type=\"text\" placeholder=\"Enter Message!\" onChange={onChangeText} value={textMessage} />\n                                            <span className=\"publisher-btn file-group\">\n                                                <i className=\"fa fa-paperclip file-browser\"></i>\n                                                <input type=\"file\" />\n                                            </span>\n                                            <a className=\"publisher-btn\" href=\"#\" data-abc=\"true\">\n                                                <i className=\"fa fa-smile\"></i>\n                                            </a>\n                                            <a onClick={handlerSend} className=\"publisher-btn text-info\" data-abc=\"true\">\n                                                <i className=\"fa fa-paper-plane\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        )\n                    }\n                </div>\n            }\n        </>\n    );\n}\n\nexport default Chat;"]},"metadata":{},"sourceType":"module"}