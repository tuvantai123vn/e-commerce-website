{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Volumes/document/GitHub/ASM3/Frontend Assignment 03/client/src/Cart/Cart.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { deleteCart, updateCart } from '../Redux/Action/ActionCart';\nimport ListCart from './Component/ListCart';\nimport alertify from 'alertifyjs';\nimport { Link, Redirect } from 'react-router-dom';\nimport CartAPI from '../API/CartAPI';\nimport convertMoney from '../../convertMoney';\n\nfunction Cart(props) {\n  _s();\n\n  //id_user được lấy từ redux\n  const id_user = useSelector(state => state.Cart.id_user); //listCart được lấy từ redux\n\n  const listCart = useSelector(state => state.Cart.listCart);\n  const [cart, setCart] = useState([]);\n  const [total, setTotal] = useState();\n  const dispatch = useDispatch(); //State dùng để Load dữ liệu từ Redux\n\n  const [loadRedux, setLoadRedux] = useState({\n    idProduct: '',\n    count: ''\n  }); //State dùng để Load dữ liệu từ API\n\n  const [loadAPI, setLoadAPI] = useState(false); //Hàm này dùng để Load dữ liệu ở Redux\n  //Khi người dùng chưa đăng nhập\n\n  useEffect(() => {\n    const fetchDataRedux = () => {\n      if (!localStorage.getItem('id_user')) {\n        setCart(listCart);\n        getTotal(listCart);\n      }\n    };\n\n    fetchDataRedux();\n  }, [loadRedux]); //Hàm này dùng để tính tổng tiền carts\n\n  function getTotal(cart) {\n    let sub_total = 0;\n    const sum_total = cart.cart.map(value => {\n      return sub_total += parseInt(value.product.price) * parseInt(value.quantity);\n    });\n    setTotal(sub_total);\n  } //Hàm này dùng để load dữ liệu từ API\n  //Khi người dùng đã đăng nhập\n\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (localStorage.getItem('id_user')) {\n        const params = {\n          idUser: localStorage.getItem('id_user')\n        };\n        const response = await CartAPI.getCarts(params.idUser);\n        setCart(response);\n        console.log(response);\n        getTotal(response);\n      }\n    };\n\n    fetchData();\n    setLoadAPI(false);\n  }, [loadAPI]); //Hàm này dùng để truyền xuống cho component con xử và trả ngược dữ liệu lại component cha \n\n  const onDeleteCart = (getUser, getProduct) => {\n    console.log(\"idUser: \" + getUser + \", idProduct: \" + getProduct);\n\n    if (localStorage.getItem('id_user')) {\n      // user đã đăng nhập\n      //Sau khi nhận được dữ liệu ở component con truyền lên thì sẽ gọi API xử lý dữ liệu\n      const fetchDelete = async () => {\n        const params = {\n          idUser: getUser,\n          idProduct: getProduct\n        };\n        const response = await CartAPI.deleteToCart(params);\n        console.log(response);\n      };\n\n      fetchDelete(); //Sau đó thay đổi state loadAPI và load lại hàm useEffect\n\n      setLoadAPI(true);\n      alertify.set('notifier', 'position', 'bottom-left');\n      alertify.error('Bạn Đã Xóa Hàng Thành Công!');\n    } else {\n      // user chưa đăng nhập\n      //Nếu không có phiên làm việc của Session User thì mình sẽ xử lý với Redux\n      const data = {\n        idProduct: getProduct,\n        idUser: getUser\n      }; //Đưa dữ liệu vào Redux\n\n      const action = deleteCart(data);\n      dispatch(action);\n      alertify.set('notifier', 'position', 'bottom-left');\n      alertify.error('Bạn Đã Xóa Hàng Thành Công!'); //set state loadRedux để nó load lại hàm useEffect để tiếp tục lấy dữ liệu từ redux\n\n      setLoadRedux({\n        idProduct: getProduct,\n        count: ''\n      });\n    }\n  }; //Hàm này dùng để truyền xuống cho component con xử và trả ngược dữ liệu lại component cha \n\n\n  const onUpdateCount = (getUser, getProduct, getCount) => {\n    console.log(\"Count: \" + getCount + \", idUser: \" + getUser + \", idProduct: \" + getProduct);\n\n    if (localStorage.getItem('id_user')) {\n      // user đã đăng nhập\n      //Sau khi nhận được dữ liệu ở component con truyền lên thì sẽ gọi API xử lý dữ liệu\n      const fetchPut = async () => {\n        const params = {\n          idUser: getUser,\n          idProduct: getProduct,\n          count: getCount\n        };\n        const response = await CartAPI.putToCart(params);\n        console.log(response);\n      };\n\n      fetchPut(); //Sau đó thay đổi state loadAPI và load lại hàm useEffect\n\n      setLoadAPI(true);\n      console.log(\"Ban Da Dang Nhap!\");\n      alertify.set('notifier', 'position', 'bottom-left');\n      alertify.success('Bạn Đã Sửa Hàng Thành Công!');\n    } else {\n      //Nếu không có phiên làm việc của Session User thì mình sẽ xử lý với Redux\n      const data = {\n        idProduct: getProduct,\n        idUser: getUser,\n        count: getCount\n      }; //Đưa dữ liệu vào Redux\n\n      const action = updateCart(data);\n      dispatch(action);\n      alertify.set('notifier', 'position', 'bottom-left');\n      alertify.success('Bạn Đã Sửa Hàng Thành Công!'); //set state loadRedux để nó load lại hàm useEffect để tiếp tục lấy dữ liệu từ redux\n\n      setLoadRedux({\n        idProduct: getProduct,\n        count: getCount\n      });\n    }\n  }; //Hàm này dùng để redirect đến page checkout\n\n\n  const [redirect, setRedirect] = useState(false);\n\n  const onCheckout = () => {\n    if (!localStorage.getItem('id_user')) {\n      alertify.set('notifier', 'position', 'bottom-left');\n      alertify.error('Vui Lòng Kiểm Tra Lại Đăng Nhập!');\n      return;\n    }\n\n    if (cart.length === 0) {\n      alertify.set('notifier', 'position', 'bottom-left');\n      alertify.error('Vui Lòng Kiểm Tra Lại Giỏ Hàng!');\n      return;\n    }\n\n    setRedirect(true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"py-5 bg-light\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row px-4 px-lg-5 py-lg-4 align-items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-lg-6\",\n            children: /*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"h2 text-uppercase mb-0\",\n              children: \"Cart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-lg-6 text-lg-right\",\n            children: /*#__PURE__*/_jsxDEV(\"nav\", {\n              \"aria-label\": \"breadcrumb\",\n              children: /*#__PURE__*/_jsxDEV(\"ol\", {\n                className: \"breadcrumb justify-content-lg-end mb-0 px-0\",\n                children: /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"breadcrumb-item active\",\n                  \"aria-current\": \"page\",\n                  children: \"Cart\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"py-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"h5 text-uppercase mb-4\",\n        children: \"Shopping cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-8 mb-4 mb-lg-0\",\n          children: [/*#__PURE__*/_jsxDEV(ListCart, {\n            listCart: cart,\n            onDeleteCart: onDeleteCart,\n            onUpdateCount: onUpdateCount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-light px-4 py-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row align-items-center text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 mb-3 mb-md-0 text-md-left\",\n                children: /*#__PURE__*/_jsxDEV(Link, {\n                  className: \"btn btn-link p-0 text-dark btn-sm\",\n                  to: `/shop`,\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-long-arrow-alt-left mr-2\",\n                    children: \" \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 255,\n                    columnNumber: 41\n                  }, this), \"Continue shopping\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 text-md-right\",\n                children: [redirect && /*#__PURE__*/_jsxDEV(Redirect, {\n                  to: '/checkout'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 53\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"btn btn-outline-dark btn-sm\",\n                  onClick: onCheckout,\n                  children: [\"Procceed to checkout\", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-long-arrow-alt-right ml-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 263,\n                    columnNumber: 61\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card border-0 rounded-0 p-lg-4 bg-light\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-body\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"text-uppercase mb-4\",\n                children: \"Cart total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"list-unstyled mb-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"d-flex align-items-center justify-content-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    className: \"text-uppercase small font-weight-bold\",\n                    children: \"Subtotal\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 274,\n                    columnNumber: 103\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-muted small\",\n                    children: [\"$\", total]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 274,\n                    columnNumber: 178\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"border-bottom my-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 275,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"d-flex align-items-center justify-content-between mb-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    className: \"text-uppercase small font-weight-bold\",\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 276,\n                    columnNumber: 108\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [\"$\", total]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 276,\n                    columnNumber: 180\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 276,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 224,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Cart, \"Ue7F4meyflwCMIHdQ3FWjnuML7g=\", false, function () {\n  return [useSelector, useSelector, useDispatch];\n});\n\n_c = Cart;\nexport default Cart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"sources":["/Volumes/document/GitHub/ASM3/Frontend Assignment 03/client/src/Cart/Cart.jsx"],"names":["React","useEffect","useState","useDispatch","useSelector","deleteCart","updateCart","ListCart","alertify","Link","Redirect","CartAPI","convertMoney","Cart","props","id_user","state","listCart","cart","setCart","total","setTotal","dispatch","loadRedux","setLoadRedux","idProduct","count","loadAPI","setLoadAPI","fetchDataRedux","localStorage","getItem","getTotal","sub_total","sum_total","map","value","parseInt","product","price","quantity","fetchData","params","idUser","response","getCarts","console","log","onDeleteCart","getUser","getProduct","fetchDelete","deleteToCart","set","error","data","action","onUpdateCount","getCount","fetchPut","putToCart","success","redirect","setRedirect","onCheckout","length"],"mappings":"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","sourcesContent":["\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { deleteCart, updateCart } from '../Redux/Action/ActionCart';\nimport ListCart from './Component/ListCart';\nimport alertify from 'alertifyjs'\nimport { Link, Redirect } from 'react-router-dom'\nimport CartAPI from '../API/CartAPI';\nimport convertMoney from '../../convertMoney';\n\n\nfunction Cart(props) {\n\n    //id_user được lấy từ redux\n    const id_user = useSelector(state => state.Cart.id_user)\n\n    //listCart được lấy từ redux\n    const listCart = useSelector(state => state.Cart.listCart)\n\n    const [cart, setCart] = useState([])\n\n    const [total, setTotal] = useState()\n\n    const dispatch = useDispatch()\n\n    //State dùng để Load dữ liệu từ Redux\n    const [loadRedux, setLoadRedux] = useState({\n        idProduct: '',\n        count: ''\n    })\n\n    //State dùng để Load dữ liệu từ API\n    const [loadAPI, setLoadAPI] = useState(false)\n\n    //Hàm này dùng để Load dữ liệu ở Redux\n    //Khi người dùng chưa đăng nhập\n    useEffect(() => {\n\n        const fetchDataRedux = () => {\n\n            if (!localStorage.getItem('id_user')){\n                setCart(listCart)\n\n                getTotal(listCart)\n            }\n\n        }\n\n        fetchDataRedux()\n\n    }, [loadRedux])\n\n    //Hàm này dùng để tính tổng tiền carts\n    function getTotal(cart) {\n        let sub_total = 0\n                \n        const sum_total = cart.cart.map(value => {\n            return sub_total += parseInt(value.product.price) * parseInt(value.quantity)\n        })\n\n        setTotal(sub_total)\n    }\n\n    //Hàm này dùng để load dữ liệu từ API\n    //Khi người dùng đã đăng nhập\n    useEffect(() => {\n\n        const fetchData = async () => {\n\n            if (localStorage.getItem('id_user')){\n\n                const params = {\n                    idUser: localStorage.getItem('id_user')\n                }\n\n                const response = await CartAPI.getCarts(params.idUser)\n\n                setCart(response)\n\n\t\t\t\tconsole.log(response);\n\n                getTotal(response)\n\n            }\n\n        }\n\n        fetchData()\n\n        setLoadAPI(false)\n\n    }, [loadAPI])\n\n\n    //Hàm này dùng để truyền xuống cho component con xử và trả ngược dữ liệu lại component cha \n    const onDeleteCart = (getUser, getProduct) => {\n        console.log( \"idUser: \" + getUser + \", idProduct: \" + getProduct)\n\n        if (localStorage.getItem('id_user')){ // user đã đăng nhập\n\n            //Sau khi nhận được dữ liệu ở component con truyền lên thì sẽ gọi API xử lý dữ liệu\n            const fetchDelete = async () => {\n\n                const params = {\n                    idUser: getUser,\n                    idProduct: getProduct\n                }\n\n                const response = await CartAPI.deleteToCart(params)\n                console.log(response)\n\n            }\n\n            fetchDelete()\n\n            //Sau đó thay đổi state loadAPI và load lại hàm useEffect\n            setLoadAPI(true)\n\n            alertify.set('notifier','position', 'bottom-left');\n            alertify.error('Bạn Đã Xóa Hàng Thành Công!');\n\n        }else{ // user chưa đăng nhập\n\n            //Nếu không có phiên làm việc của Session User thì mình sẽ xử lý với Redux\n            const data = {\n                idProduct: getProduct,\n                idUser: getUser,\n            }\n\n            //Đưa dữ liệu vào Redux\n            const action = deleteCart(data)\n            dispatch(action)\n\n            alertify.set('notifier','position', 'bottom-left');\n            alertify.error('Bạn Đã Xóa Hàng Thành Công!');\n\n            //set state loadRedux để nó load lại hàm useEffect để tiếp tục lấy dữ liệu từ redux\n            setLoadRedux({\n                idProduct: getProduct,\n                count: ''\n            })\n            \n        }\n\n    }\n\n    //Hàm này dùng để truyền xuống cho component con xử và trả ngược dữ liệu lại component cha \n    const onUpdateCount = (getUser, getProduct, getCount) => {\n        console.log(\"Count: \" + getCount + \", idUser: \" + getUser + \", idProduct: \" + getProduct)\n\n        if (localStorage.getItem('id_user')){ // user đã đăng nhập\n\n            //Sau khi nhận được dữ liệu ở component con truyền lên thì sẽ gọi API xử lý dữ liệu\n            const fetchPut = async () => {\n\n                const params = {\n                    idUser: getUser,\n                    idProduct: getProduct,\n                    count: getCount\n                }\n\n                const response = await CartAPI.putToCart(params)\n                console.log(response)\n                \n            }\n\n            fetchPut()\n\n            //Sau đó thay đổi state loadAPI và load lại hàm useEffect\n            setLoadAPI(true)\n\n            console.log(\"Ban Da Dang Nhap!\")\n\n            alertify.set('notifier','position', 'bottom-left');\n            alertify.success('Bạn Đã Sửa Hàng Thành Công!');\n\n        }else{\n\n            //Nếu không có phiên làm việc của Session User thì mình sẽ xử lý với Redux\n            const data = {\n                idProduct: getProduct,\n                idUser: getUser,\n                count: getCount\n            }\n\n            //Đưa dữ liệu vào Redux\n            const action = updateCart(data)\n            dispatch(action)\n\n            alertify.set('notifier','position', 'bottom-left');\n            alertify.success('Bạn Đã Sửa Hàng Thành Công!');\n\n            //set state loadRedux để nó load lại hàm useEffect để tiếp tục lấy dữ liệu từ redux\n            setLoadRedux({\n                idProduct: getProduct,\n                count: getCount\n            })\n        }\n\n    }\n\n    //Hàm này dùng để redirect đến page checkout\n    const [redirect, setRedirect] = useState(false)\n\n    const onCheckout = () => {\n        \n        if (!localStorage.getItem('id_user')){\n            alertify.set('notifier','position', 'bottom-left');\n            alertify.error('Vui Lòng Kiểm Tra Lại Đăng Nhập!');\n            return\n        }\n\n        if (cart.length === 0){\n            alertify.set('notifier','position', 'bottom-left');\n            alertify.error('Vui Lòng Kiểm Tra Lại Giỏ Hàng!');\n            return\n        }\n        \n        setRedirect(true)\n\n    }\n\n    return (\n        <div className=\"container\">\n            <section className=\"py-5 bg-light\">\n                <div className=\"container\">\n                    <div className=\"row px-4 px-lg-5 py-lg-4 align-items-center\">\n                        <div className=\"col-lg-6\">\n                            <h1 className=\"h2 text-uppercase mb-0\">Cart</h1>\n                        </div>\n                        <div className=\"col-lg-6 text-lg-right\">\n                            <nav aria-label=\"breadcrumb\">\n                                <ol className=\"breadcrumb justify-content-lg-end mb-0 px-0\">\n                                    <li className=\"breadcrumb-item active\" aria-current=\"page\">Cart</li>\n                                </ol>\n                            </nav>\n                        </div>\n                    </div>\n                </div>\n            </section>\n            <section className=\"py-5\">\n                <h2 className=\"h5 text-uppercase mb-4\">Shopping cart</h2>\n                <div className=\"row\">\n                    <div className=\"col-lg-8 mb-4 mb-lg-0\">\n                        \n                        <ListCart \n                            listCart={cart} \n                            onDeleteCart={onDeleteCart} \n                            onUpdateCount={onUpdateCount} />\n\n                        <div className=\"bg-light px-4 py-3\">\n                            <div className=\"row align-items-center text-center\">\n                                <div className=\"col-md-6 mb-3 mb-md-0 text-md-left\">\n                                    <Link className=\"btn btn-link p-0 text-dark btn-sm\" to={`/shop`}>\n                                        <i className=\"fas fa-long-arrow-alt-left mr-2\"> </i>Continue shopping\n                                    </Link>                \n                                </div>\n                                <div className=\"col-md-6 text-md-right\">\n                                    {\n                                        redirect && <Redirect to={'/checkout'} />\n                                    }\n                                    <span className=\"btn btn-outline-dark btn-sm\" onClick={onCheckout}>\n                                        Procceed to checkout<i className=\"fas fa-long-arrow-alt-right ml-2\"></i>\n                                    </span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"col-lg-4\">\n                        <div className=\"card border-0 rounded-0 p-lg-4 bg-light\">\n                            <div className=\"card-body\">\n                                <h5 className=\"text-uppercase mb-4\">Cart total</h5>\n                                <ul className=\"list-unstyled mb-0\">\n                                    <li className=\"d-flex align-items-center justify-content-between\"><strong className=\"text-uppercase small font-weight-bold\">Subtotal</strong><span className=\"text-muted small\">${total}</span></li>\n                                    <li className=\"border-bottom my-2\"></li>\n                                    <li className=\"d-flex align-items-center justify-content-between mb-4\"><strong className=\"text-uppercase small font-weight-bold\">Total</strong><span>${total}</span></li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </section>\n        </div>\n    );\n}\n\nexport default Cart;"]},"metadata":{},"sourceType":"module"}